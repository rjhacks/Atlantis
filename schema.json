// Actually this is a JavaScript file rather than a JSON file,
// but all it does is load some JSON into a variable for us.
//
// The following is a JSON schema that describes the format in which we'd like
// our clients and servers to interact.
serialized_schema = `
{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Atlantis",
  "description": "A schema to represent a complete game of Atlantis",
  "type": "object",
  "definitions": {
    "player": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer"
        },
        "name": {
          "type": "string"
        }
      },
      "required": [
        "id"
      ]
    },
    "point": {
      "type": "object",
      "properties": {
        "x": {
          "type": "integer"
        },
        "y": {
          "type": "integer"
        }
      },
      "required": [
        "x",
        "y"
      ]
    },
    "segment": {
      "description": "Segments are defined by their center point",
      "$ref": "#definitions/point"
    },
    "tower": {
      "type": "object",
      "properties": {
        "position": {
          "$ref": "#/definitions/point"
        },
        "player": {
          "$ref": "#/definitions/player/id"
        },
        "is_growing_point": {
          "description": "If present, indicates whether this tower is a growing point. Otherwise, assumed false.",
          "type": "boolean"
        },
        "height": {
          "type": "integer",
          "minimum": 1,
          "maximum": 6
        }
      },
      "required": [
        "position",
        "player",
        "height"
      ]
    },
    "dead_point": {
      "type": "object",
      "properties": {
        "position": {
          "$ref": "#definitions/point"
        },
        "turn_of_death": {
          "description": "The turn in which this point died. Implies which player was responsible.",
          "$ref": "#/definitions/turn/properties/number"
        }
      },
      "required": [
        "position",
        "turn_of_death"
      ]
    },
    "move": {
      "description": "A single move done by a single player in a single turn",
      "type": "object",
      "properties": {
        "tower_origin": {
          "$ref": "#/definitions/point"
        },
        "tower_destination": {
          "$ref": "#/definitions/point"
        }
      },
      "required": [
        "tower_origin",
        "tower_destination"
      ]
    },
    "turn": {
      "description": "The set of moves done in a single turn by a single player",
      "type": "object",
      "properties": {
        "number": {
          "type": "integer"
        },
        "moves": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/move"
          }
        }
      },
      "required": [
        "number",
        "moves"
      ]
    }
  },
  "properties": {
    "rules_version": {
      "description": "A string like 'classic' or 'v2' to describe the type of rules being used for this game",
      "type": "string"
    },
    "board": {
      "description": "A snapshot of the complete state of an Atlantis board, at the start of a turn.",
      "type": "object",
      "properties": {
        "players": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/player"
          },
          "uniqueItems": true
        },
        "turn_number": {
          "description": "The number of the current turn; implies whose turn it is.",
          "$ref": "#/definitions/turn/properties/number"
        },
        "segments": {
          "description": "A list of segments present, defining the shape of the board",
          "type": "array",
          "items": {
            "$ref": "#/definitions/segment"
          },
          "uniqueItems": true
        },
        "towers": {
          "description": "All the towers on the board, showing current player positions",
          "type": "array",
          "items": {
            "$ref": "#/definitions/tower"
          },
          "uniqueItems": true
        },
        "dead_points": {
          "description": "All the dead points on the board",
          "type": "array",
          "items": {
            "$ref": "#/definitions/dead_point"
          },
          "uniqueItems": true
        }
      },
      "required": [
        "players",
        "turn_number",
        "segments",
        "towers",
        "dead_points"
      ]
    },
    "turns": {
      "description": "The set of moves done by a number of players in a number of turns, useful as a delta from a known board state",
      "type": "array",
      "items": {
        "$ref": "#/definitions/turn"
      }
    }
  }
}
`;
